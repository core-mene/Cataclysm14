# SPDX-FileCopyrightText: 2025 Ghagliiarghii
# SPDX-FileCopyrightText: 2025 HungryCuban
# SPDX-FileCopyrightText: 2025 Onezero0
# SPDX-FileCopyrightText: 2025 Redrover1760
# SPDX-FileCopyrightText: 2025 core-mene
# SPDX-FileCopyrightText: 2025 significant harassment
# SPDX-FileCopyrightText: 2025 starch
#
# SPDX-License-Identifier: AGPL-3.0-or-later

- type: entity
  id: FactionLathe
  parent: BaseLatheLube
  name: military multi-purpose assembler
  description: Prints out items researched with TSFMC/Rogue R&D servers.
  components:
  - type: Sprite
    sprite: Structures/Machines/techfab.rsi
    layers:
    - state: icon
      map: [ "enum.LatheVisualLayers.IsRunning" ]
    - state: unlit
      shader: unshaded
      map: [ "enum.PowerDeviceVisualLayers.Powered"]
    - state: inserting
      map: ["enum.MaterialStorageVisualLayers.Inserting"]
    - state: panel
      map: ["enum.WiresVisualLayers.MaintenancePanel"]
  - type: Machine
    board: MilitaryTechfabMachineCircuitboard
  - type: Lathe
    producingSound: /Audio/Machines/circuitprinter.ogg
    idleState: icon
    runningState: icon
    staticPacks:
    - StaticAmmoRecipePack
    - NFMercenaryTechfabDeprecatedStatic
    dynamicPacks:
    # rogue start
    - MonoRogueWeaponsDynamicMelee
    - MonoRogueWeaponsDynamicRanged
    - MonoRogueVouchersDynamic
    - MonoRogueMiscDynamic
    - MonoRogueGearDynamic
    - MonoRogueGearProDynamic
    # TSF start
    - MonoTSFWeaponsDynamicMelee
    - MonoTSFWeaponsDynamicRanged
    - MonoTSFVouchersDynamic
    - MonoTSFMiscDynamic
    - MonoTSFGearDynamic
    - MonoTSFStructuresDynamic
    # USSP start
    - MonoUSSPVouchersDynamic
    - MonoUSSPArmorDynamic
    - MonoUSSPMiscDynamic
    - MonoUSSPWeaponsDynamicRanged
    # Universal shit (stuff like shipgun ammo)
    - UniversalRailgunAmmo
    - UniversalMissileAmmo
    - UniversalShellAmmo
    - UniversalOrdinance
    - DynamicAmmoRecipePack
    - NFMercenaryTechfabDeprecated
    # Civ military tech
    - ResearchedExplosives
  - type: MaterialStorage
    whitelist:
      tags:
      - Sheet
      - RawMaterial
      - Ingot
  - type: RequireProjectileTarget

- type: entity
  id: BaseLathe2x2
  parent: BaseLatheLube
  name: Debug 2x2 autolathe
  description: test for a 2x2 grid lathe
  components:
  - type: Sprite
    offset: 0.5,-0.5
    sprite: _Mono/Structures/Machines/autolathe_2x2.rsi
    layers:
    - state: icon
      map: ["enum.LatheVisualLayers.IsRunning"]
    - state: unlit
      shader: unshaded
      map: ["enum.PowerDeviceVisualLayers.Powered"]
    - state: inserting
      map: ["enum.MaterialStorageVisualLayers.Inserting"]
    - state: panel
      map: ["enum.WiresVisualLayers.MaintenancePanel"]
  - type: Machine
    board: MilitaryTechfabMachineCircuitboard
  - type: Lathe
    producingSound: /Audio/Machines/circuitprinter.ogg
    idleState: icon
    runningState: icon
    staticPacks:
    - StaticAmmoRecipePack
    - NFMercenaryTechfabDeprecatedStatic
  - type: MaterialStorage
    whitelist:
      tags:
      - Sheet
      - RawMaterial
      - Ingot
  - type: Construction
    graph: Machine2x2
  - type: RequireProjectileTarget
  - type: Destructible
    thresholds:
    - trigger:
        !type:DamageTrigger
        damage: 100
      behaviors:
      - !type:PlaySoundBehavior
        sound:
          collection: MetalBreak
      - !type:ChangeConstructionNodeBehavior
        node: machineFrame2x2
      - !type:DoActsBehavior
        acts: ["Destruction"]
  - type: Fixtures
    fixtures:
      fix1:
        shape:
          !type:PhysShapeAabb
          bounds: "1.25,0.25,-0.25,-1.25"
        density: 155
        mask:
        - MachineMask
        layer:
        - MachineLayer